\documentclass[12pt]{article}
\title{M374M Homework 4 \\
  \normalsize{\S~2.1 \#3, 5$^1$; \S~2.2 \#1a, 1f, 5$^2$}}
\author{Hershal Bhave (hb6279)}
\date{Due 2016--02--22}

\usepackage{macros}

\begin{document}
\maketitle
\section{\S~2.1}
\subsection{3}
\subsubsection*{Problem}
For the system
\begin{equation}
  \begin{aligned}
    x'&=y^2 \\
    y'&=-\frac{2}{3}x, \\
  \end{aligned}
\end{equation}
find critical points, nullclines, and the direction of the orbits in the regions
separated by the nullclines. Next, find the equations of the orbits and plot the
phase diagram. Is the origin stable or unstable?
\subsubsection*{Solution}
Let
\begin{equation}
  \begin{aligned}
    f(x,y) &= y^2 \\
    g(x,y) &= -\frac{2}{3}x.
  \end{aligned}
\end{equation}
This is a coupled system. We must solve $f(x,y)=0$ and $g(x,y)=0$ to obtain the
critical points/equilibria and nullclines of the system.
\begin{multicols}{2}
  \begin{equation*}
    \begin{aligned}
      y^2 &= 0 \\
      \implies y &= 0.
    \end{aligned}
  \end{equation*}
  \begin{equation*}
    \begin{aligned}
      -\frac{2}{3}x &= 0 \\
      \implies x &= 0.
    \end{aligned}
  \end{equation*}
\end{multicols} \noindent
From this result we can conclude that the critical point is $(0,0)$ and that the
nullclines follow the lines $y=0$, $x=0$. To find the equations of the orbits we
must solve the ODE.
\begin{equation}
  \begin{aligned}
    \od{y}{t} &= -\frac{2}{3}x \\
    \od{y}{t} \od{t}{x} &= -\frac{2}{3}x \od{t}{x} \\
    \od{y}{x} &= -\frac{2}{3}\frac{x}{y^2} \\
    \int 3y^2 \dd{y} &= \int -2x^2 \dd{x} \\
    y^3 &= -x^2 + C \\
    \implies y^3 + x^2 &= C
  \end{aligned}
\end{equation}
The phase diagram is plotted in \cref{fig:3-phase-diagram}.

\todo[clean up code comments and phase diagram]
% \begin{tikzpicture}[domain=-3:3,x=2cm,y=1cm]
%   \begin{axis}[axis x line=center,
%     axis y line=center,
%     xlabel=$x$,ylabel=$y$];

%     \foreach \c in {0,2,4,...,10} {
%       \addplot[blue,domain=-3:3] {(-(x^2)+\c)^(1/3)};
%     }
%   \end{axis}
% \end{tikzpicture}

% \begin{tikzpicture}[xscale=1,yscale=.25]
%     \draw plot[id=curve, raw gnuplot] function{
%       f(x,y) = y**2 + (x**2 - 5)*(4*x**4 - 20*x**2 + 25);
%       set xrange [-4:4];
%       set yrange [-15:15];
%       set view 0,0;
%       set isosample 1000,1000;
%       %set size square;
%       set cont base;
%       set cntrparam levels incre 0,0.1,0;
%       unset surface;
%       splot f(x,y)
%     };
%   \end{tikzpicture}

\tikzset{
    set arrow inside/.code={\pgfqkeys{/tikz/arrow inside}{#1}},
    set arrow inside={end/.initial=>, opt/.initial=},
    /pgf/decoration/Mark/.style={
        mark/.expanded=at position #1 with
        {
            \noexpand\arrow[\pgfkeysvalueof{/tikz/arrow inside/opt}]{\pgfkeysvalueof{/tikz/arrow inside/end}}
        }
    },
    arrow inside/.style 2 args={
        set arrow inside={#1},
        postaction={
            decorate,decoration={
                markings,Mark/.list={#2}
            }
        }
    },
}
\tikzset{->-/.style={decoration={
  markings,
  mark=at position #1 with {\arrow{>}}},postaction={decorate}}}

% \tikzset{
%     on each segment/.style={
%         decorate,
%         decoration={
%             show path construction,
%             moveto code={},
%             lineto code={
%                 \path [#1]
%                 (\tikzinputsegmentfirst) -- (\tikzinputsegmentlast);
%             },
%             curveto code={
%                 \path [#1] (\tikzinputsegmentfirst)
%                 .. controls
%                 (\tikzinputsegmentsupporta) and (\tikzinputsegmentsupportb)
%                 ..
%                 (\tikzinputsegmentlast);
%             },
%             closepath code={
%                 \path [#1]
%                 (\tikzinputsegmentfirst) -- (\tikzinputsegmentlast);
%             },
%         },
%     },
% }
% \begin{tikzpicture}
%   \draw[->] (0,-4) -- (0,4) node[left] {$y$};
%   \draw[->] (-4,0) -- (4,0) node[below] {$x$};
%   \draw[color=blue] plot[id=curve, raw gnuplot, smooth,tension=1] function{
%     f(x,y,c) = y**3+x**2+c;
%     set xrange [-4:4];
%     set yrange [-4:4];
%     set view 0,0;
%     set isosample 50,50;
%     % set table;
%     set size square;
%     set cont base;
%     set cntrparam levels incre 0,0.1,0;
%     unset surface;
%     splot for [c=-4:4] f(x,y,c)
%   };
% \end{tikzpicture}

\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{axis}[ domain=-4:4, view={0}{90}, axis x line=center, axis y
      line=center, xlabel=$x$, ylabel=$y$, x label style={anchor=west}, y label
      style={anchor=south}, ]
      \addplot3[contour gnuplot={number=20,labels=false}]{y^3+x^2};
      % \addplot3[contour gnuplot={number=20}, decoration={
      % markings,
      % mark=between positions 0.1 and 1 step 8em with
      % {\arrow[scale=1.5]{stealth}}},postaction=decorate]{y^3+x^2+3};
      \addplot3[blue, quiver={ u={y^2}, v={-2/3*x}, scale arrows=0.05 },
      -stealth,samples=10]{0};
    \end{axis}
  \end{tikzpicture}
  \caption{Phase Diagram for \S~2.1\#3}
  \label{fig:3-phase-diagram}
\end{figure}

% \begin{tikzpicture}
%   \begin{axis}[
%       axis equal,
%       axis x line = middle,
%       axis y line = middle,
%       xlabel      = {$x$},
%       ylabel      = {$y$},
%     ]
%     \foreach \c in {-4,-3,...,4} {
%       \addplot [domain = -4:4,samples=100, unbounded coords=jump]
%       {(-x^2+\c)^(1/3)};
%     }
%   \end{axis}
% \end{tikzpicture}

\newpage
\subsection{5$^2$}
\subsubsection*{Problem}
Find the linearization of the system
\begin{equation}
  \begin{aligned}
    x'&=y-x \\
    y'&=-y+\frac{5x^2}{4+x^2} \\
  \end{aligned}
\end{equation}
about the equilibrium point $(1,1)$. Draw the nullclines and indicate the
direction of the orbits in each region separated by the nullclines. Can you
conclude anything baout the stability of the critical point?
\subsubsection*{Remarks}
Instead of the linearization, find all equilibria; sketch the direction of
solution curves in a small region around each equilibrium in the phase plane.
\subsubsection*{Solution}
Let
\begin{equation}
  \begin{aligned}
    f(x,y) &= y-x \\
    g(x,y) &= -y+\frac{5x^2}{4+x^2}. \\
  \end{aligned}
\end{equation}
We must solve $f(x,y)=0$ and $g(x,y)=0$ to obtain the equilibria of the system.
Since this system is nonlinear we may solve using substitution.
\begin{equation}
  y - x = 0 \implies y = x
\end{equation}
From this result,
\begin{equation}
  \begin{aligned}
    -y+\frac{5x^2}{4+x^2} &= 0 \\
    -x+\frac{5x^2}{4+x^2} &= 0 \\
    \frac{5x^2}{4+x^2} &= x \\
    5x^2 &= x(4+x^2) \\
    5x &= 4+x^2 \\
    x^2-5x+4 &= 0 \\
    (x-5)(x-1) &= 0 \\
    \implies x &= 1, 4. \\
  \end{aligned}
\end{equation}
We may conclude that the equilibria are $(1,1)$, $(4,4)$.
\todo[find the solution curves]
\section{\S~2.2}
\subsection{1a}
\subsubsection*{Problem}
Find the general solution of \cref{eq:1a-problem} and sketch the phase diagrams
for the system; characterize the equilibria as to type (node, etc.) and
stability.
\begin{equation}
  \label{eq:1a-problem}
  \begin{aligned}
    x'=f(x,y)&=x-3y\\
    y'=g(x,y)&=-3x+y,\\
  \end{aligned}
\end{equation}
\subsubsection*{Solution}
We must solve $f(x,y)=0$ and $g(x,y)=0$ to obtain the equilibria of the system.
Since this problem is linear we may construct a matrix and use various linear
techniques to characterize and ultimately solve the system. We'll start off by
obtaining the equlibria.

\begin{equation*}
  A = \begin{pmatrix}1&-3\\-3&1\\\end{pmatrix}
  = \begin{pmatrix}1&0\\0&1\\\end{pmatrix}
\end{equation*}
The null space of $A$ is
$$\begin{pmatrix}x\\y\end{pmatrix} = \begin{pmatrix}0\\0\end{pmatrix},$$ which
implies that the equlibrium point is $(0,0)$. Now we will find the eigenvalues of
$A$ to characterize the solution about its equilibrium.
\begin{equation*}
  \begin{vmatrix}1-\lambda&-3\\-3&1-\lambda\end{vmatrix} = {(1-\lambda)}^2 - 9 = 0
\end{equation*}
From this point we know there are two distinct, real eigenvalues.
\begin{equation*}
  \begin{aligned}
    1-\lambda_1&=3 &\quad -1+\lambda_2&=3 \\
    \implies\lambda_1 &=-2 &\quad \implies\lambda_2 &= 4 \\
  \end{aligned}
\end{equation*}
Now we require the eigenvectors of $A$ so that the nullclines may be drawn atop
the solution.
\begin{equation*}
  \begin{aligned}
    &\begin{pmatrix}1-\lambda_1&-3\\-3&1-\lambda_1\end{pmatrix}
    \rightarrow\begin{pmatrix}3&-3\\-3&3\end{pmatrix}
    \rightarrow\begin{pmatrix}1&-1\\0&0\end{pmatrix}
    &&\implies \vec{v_1} = \begin{pmatrix}1\\1\end{pmatrix}y, \\
    &\begin{pmatrix}1-\lambda_2&-3\\-3&1-\lambda_2\end{pmatrix}
    \rightarrow\begin{pmatrix}-3&-3\\-3&-3\end{pmatrix}
    \rightarrow\begin{pmatrix}1&1\\0&0\end{pmatrix}
    &&\implies \vec{v_2} = \begin{pmatrix}1\\-1\end{pmatrix}y.
  \end{aligned}
\end{equation*}
The general solution is unstable with a saddle equilibrium. Reference \todo[figure].
$$\boxed{\begin{pmatrix}x\\y\end{pmatrix}(t)=C_1\begin{pmatrix}1\\1\end{pmatrix}e^{-2t}+C_2\begin{pmatrix}1\\-1\end{pmatrix}e^{4t}}$$

\newpage
\subsection{1f}
\subsubsection*{Problem}
Find the general solution of \cref{eq:1f-problem} and sketch the phase diagrams
for the system; characterize the equilibria as to type (node, etc.) and
stability.
\begin{equation}
  \label{eq:1f-problem}
  \begin{aligned}
    x'=f(x,y)&=-2x-3y\\
    y'=g(x,y)&=3x-2y,\\
  \end{aligned}
\end{equation}
\subsubsection*{Solution}
We must solve $f(x,y)=0$ and $g(x,y)=0$ to obtain the equilibria of the system.
Since this problem is linear we may construct a matrix and use various linear
techniques to characterize and ultimately solve the system. We'll start off by
obtaining the equlibria.
\begin{equation*}
  A = \begin{pmatrix}-2&3\\-3&-2\\\end{pmatrix}
  = \begin{pmatrix}1&0\\0&1\\\end{pmatrix}
\end{equation*}
The null space of $A$ is
$$\begin{pmatrix}x\\y\end{pmatrix} = \begin{pmatrix}0\\0\end{pmatrix},$$ which
implies that the equlibrium point is $(0,0)$. Now we will find the eigenvalues of
$A$ to characterize the solution about its equilibrium.
\begin{equation*}
  \begin{vmatrix}-2-\lambda&3\\-3&-2-\lambda\end{vmatrix} = {(-2-\lambda)}^2 + 9 = 0
\end{equation*}
From this point we know there are two distinct, complex eigenvalues.
\begin{equation*}
  \begin{aligned}
    -2-\lambda_1&=3i &\quad 2+\lambda_2&=3i \\
    \implies\lambda_1 &=-3i-2 &\quad \implies\lambda_2 &= 3i-2 \\
  \end{aligned}
\end{equation*}
Now we require the eigenvectors of $A$ so that the nullclines may be drawn atop
the solution.
\begin{equation*}
  \begin{aligned}
    &\begin{pmatrix}-2-\lambda_1&-3\\3&-2-\lambda_1\end{pmatrix}
    \rightarrow\begin{pmatrix}3i&-3\\3&3i\end{pmatrix}
    \rightarrow\begin{pmatrix}1&i\\0&0\end{pmatrix}
    &&\implies \vec{v_1} = \begin{pmatrix}-i\\1\end{pmatrix}y, \\
    &\begin{pmatrix}-2-\lambda_1&-3\\3&-2-\lambda_1\end{pmatrix}
    \rightarrow\begin{pmatrix}3i&-3\\3&3i\end{pmatrix}
    \rightarrow\begin{pmatrix}1&-i\\0&0\end{pmatrix}
    &&\implies \vec{v_2} = \begin{pmatrix}i\\1\end{pmatrix}y.
  \end{aligned}
\end{equation*}
The general solution is stable with a spiral equilibrium. Reference \todo[figure].
$$\boxed{\begin{pmatrix}x\\y\end{pmatrix}(t)=C_1e^{-2t}\left[\begin{pmatrix}0\\1\end{pmatrix}\cos(-3t)
  -\begin{pmatrix}-1\\0\end{pmatrix}\sin(-3t)\right]+
C_2e^{-2t}\left[\begin{pmatrix}0\\1\end{pmatrix}\cos(3t)
  -\begin{pmatrix}1\\0\end{pmatrix}\sin(3t)\right]}
$$
\newpage
\subsection{5$^2$}
\subsubsection*{Problem}
At time $t=0$ a chemical herbicide is sprayed on a soil in a field of crops. Let
$x$ be the amount of herbicide in the crop, and let $y$ be the amount of
herbicide in the soil. Suppose herbicide is transferred from the soil to the
crop at rate $\beta y$ and transferred from the crop to the soil at rate $\alpha
x$; further, assume that the chemical degrades in the soil at rate $\gamma y$.
Set up a model for the amounts of herbicide in the crop and in soil. Sketch a
phase plane diagram indicating how the system evolves in time.
\subsubsection*{Remarks}
Assume $\alpha$, $\beta$, and $\gamma$ are arbitrary positive constants; account
for gains and losses in $x$ and $y$ with appropriate signs in the model
equations.
\subsubsection*{Solution}
Let
\begin{equation}
  \label{eq:2.2.5-model}
  \begin{aligned}
    \od{x}{t} &= -\alpha x + \beta y \\
    \od{y}{t} &= \alpha x - (\beta + \gamma)y. \\
  \end{aligned}
\end{equation}
Since \cref{eq:2.2.5-model} is a linear system, it may be placed in matrix form.
\begin{equation*}
  \implies A = \begin{pmatrix}
    -\alpha & \beta \\ \alpha & -(\beta+\gamma) \\
  \end{pmatrix}
\end{equation*}
Since $\det(A) \ne 0$, the system has one equilibrium at $(0,0)$. We may
categorize the solution based on its eigenvalues, which may be obtained by
solving $\det(A-\lambda I)=0$.
\begin{equation}
  \label{eq:2.2.5-eigenvalue-equation}
  \begin{aligned}
    \det(A-\lambda I) &=
    \begin{vmatrix}
      -\alpha-\lambda & \beta \\ \alpha & -(\beta+\gamma)-\lambda \\
    \end{vmatrix} \\
    0 &= (-\alpha-\lambda)(-(\beta+\gamma)-\lambda) - \beta\alpha \\
    &= (-\alpha-\lambda)(-(\beta+\gamma+\lambda)) - \beta\alpha \\
    &= (\alpha+\lambda)(\beta+\gamma+\lambda) - \beta\alpha \\
    &= \cancel{\alpha\beta} + \alpha\gamma + \alpha\lambda + \beta\lambda +
    \gamma\lambda + \lambda^2 - \cancel{\alpha\beta} \\
    &= \lambda^2 + (\alpha+\beta+\gamma)\lambda + \alpha\gamma \\
    \implies \lambda &= \frac{-(\alpha+\beta+\gamma)\pm\sqrt{{(\alpha+\beta+\gamma)}^2-4(\alpha\gamma)}}{2} \\
  \end{aligned}
\end{equation}
At this point we may categorize the eigenvalues and thus the solution based on
the discriminant in \cref{eq:2.2.5-eigenvalue-equation}. We will determine if
the eigenvalues are positive, negative, or zero.
\begin{equation}
  \label{eq:2.2.5-positive-illustration}
  \begin{aligned}
    & {(\alpha+\beta+\gamma)}^2-4(\alpha\gamma) \\
    \longleftrightarrow\quad& \alpha^2 + 2\alpha\beta + \beta^2 + 2\beta\gamma +
    \gamma^2 - 2\alpha\gamma \\
    \longleftrightarrow\quad& \alpha^2 - 2\alpha\gamma + \gamma^2 + \beta^2 +
    2\alpha\beta + 2\beta\gamma \\
    \longleftrightarrow\quad& {(\alpha-\gamma)}^2 + \gamma^2 + \beta^2 + 2\alpha\beta +
    2\beta\gamma \\
  \end{aligned}
\end{equation}
\Cref{eq:2.2.5-positive-illustration,eq:2.2.5-eigenvalue-equation} illustrate
that the system is guaranteed to have two distinct, real eigenvalues since
${(\alpha-\gamma)}^2$ is guaranteed greater than zero. We must now determine if
the eigenvalues are positive, negative, or zero. The negative condition of the
quadratic equation in \cref{eq:2.2.5-eigenvalue-equation} is guaranteed
negative. We will determine the sign of the second eigenvalue (the positive
condition of the quadratic equation). We'll do this by the assume-and-verify
method. Assume $\lambda_2<0$:
\begin{equation*}
  \begin{aligned}
    \frac{-(\alpha+\beta+\gamma)+\sqrt{{(\alpha+\beta+\gamma)}^2-4(\alpha\gamma)}}{2} &<0 \\
    -(\alpha+\beta+\gamma)+\sqrt{{(\alpha+\beta+\gamma)}^2-4(\alpha\gamma)} &<0 \\
     \sqrt{{(\alpha+\beta+\gamma)}^2-4(\alpha\gamma)} &> (\alpha+\beta+\gamma) \\
  \end{aligned}
\end{equation*}
We may square both sides and retain the inequality since we know both sides are
positive.
\begin{equation}
  \begin{aligned}
    {(\alpha+\beta+\gamma)}^2-4(\alpha\gamma) &> {(\alpha+\beta+\gamma)}^2 \\
    -4(\alpha\gamma) &< 0 \\
    \implies \alpha\gamma &> 0 \quad\checkmark
  \end{aligned}
\end{equation}
Therefore $\lambda_1,\lambda_2<0$; both eigenvalues are distinct, real, and
negative. The solution converges to the equlibrium $(0,0)$. Since we cannot
directly obtain the eigenvectors of the system, a general phase portrait of the
solution curves is illustrated in \todo[figure].
\newpage
\section{Programming Minilab}
\todo[]

\end{document}
